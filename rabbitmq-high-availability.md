## RabbitMQ 集群

### 普通集群

多个实例在多台机器上，队列只会在一个服务节点上，元数据会同步到各个节点。连接任意节点都可以消费消息。

优点：提高吞吐量

缺点：内部节点交互频繁，耗费资源。一个节点宕机，该节点上的实际数据就会丢失。


### 镜像集群

和普通模式不同，消息实体会在镜像节点间同步。消费者向任意节点请求，可以直接获取到消息。但这样也会降低系统性能。



### 镜像队列

默认情况下，queue的内容只会在queue所在的节点，但exchanges和bindings会在所有节点。queue可以run mirrors在其它节点上。

镜像队列包括leader replica和一个或多个mirrors。所有操作会先应用在leader上然后同步到mirrors。

如果leader所在的node宕机，最老的mirror会成为新的leader只要它已经被同步过。
